<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="viewport"
    content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase.js"></script>
  <!-- onsenui link  -->
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
  <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>

  <!-- leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
  <!--Font-->
  <link href="https://fonts.googleapis.com/css?family=Pridi:600&display=swap" rel="stylesheet">
  <!--Bootstrap-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

  <!-- cordova script (this will be a 404 during development) -->
  <script src="cordova.js"></script>
  <link rel="stylesheet" type="text/css" href="css/home.css">

  <title>FixingMan</title>

  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyB6QMhAaE3oktdyy8deswQNQIw4cwPq-W4",
      authDomain: "fixit-app-e3546.firebaseapp.com",
      databaseURL: "https://fixit-app-e3546.firebaseio.com",
      projectId: "fixit-app-e3546",
      storageBucket: "fixit-app-e3546.appspot.com",
      messagingSenderId: "139817871220",
      appId: "1:139817871220:web:b634b75fb562dcd2"
    };
    // Initialize Firebase


    firebase.initializeApp(firebaseConfig);
    var firestore = firebase.firestore();

  </script>

</head>

<body>
  <ons-navigator swipeable id="myNavigator1">
    <!--  Page  -->
    <ons-page>
      <!--   toolbar  -->
      <ons-toolbar style="background-color:  #ffb700 ">
        <div class="left">
          <ons-toolbar-button>
            <ons-icon onclick="chat()" icon="fa-bell" style="color: black"></ons-icon>
          </ons-toolbar-button>
        </div>

        <div class="center">Fixing Man</div>

        <div class="right">
          <ons-toolbar-button>
            <ons-icon icon="fa-sign-out-alt" style="color: black" onclick="logout()"></ons-icon>
          </ons-toolbar-button>
        </div>
      </ons-toolbar>
      <!--  //toolbar  -->

      <!--   toolbar  -->
      <ons-tabbar style="background-color: #ffb700" swipeable position="under">
        <ons-tab style="background-color: #ffb700" page="tab1.html" label="Home" icon="fa-home, material:fa-home"
          active>
        </ons-tab>
        <ons-tab style="background-color: #ffb700" page="tab2.html" label="History" icon="fa-history"
          active-icon="fa-history">
        </ons-tab>
        <ons-tab style="background-color: #ffb700" page="tab3.html" label="Setttings" icon="md-settings"
          active-icon="md-settings">
        </ons-tab>
      </ons-tabbar>
      <!-- //toolbar -->
    </ons-page>
    <!--  //page ========= -->
  </ons-navigator>
  <!--  ======================================================tab1 >> Maps ===================================================== -->
  <!-- <ons-navigator swipeable id="myNavigator1" ></ons-navigator> -->
  <template id="tab1.html">
    <ons-page id="Tab1">
      <ons-navigator swipeable id="myNavigator" page="test1.html"></ons-navigator>
      <template id="test1.html">
        <ons-page id="test1">
          <!-- map ตำแหน่งร้านของคุณ -->
          <ons-card id="map" style="width: 95%; height : 50%">


            <script>
              var map = L.map('map').setView([7.893946673324378, 98.34969520568848], 13);

              L.tileLayer('https://api.maptiler.com/maps/topo/{z}/{x}/{y}.png?key=QmcdepuuuVAKQApwz93r', {
                attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">© MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">© OpenStreetMap contributors</a>',

              }).addTo(map);

              L.marker([7.893946673324378, 98.34969520568848]).addTo(map)
                .bindPopup('ตำแหน่งร้านของคุณ')
                .openPopup();

            </script>
          </ons-card>


          <!-- ข้อมูลของร้าน -->
          <ons-card>
            <ons-card style="background-color: #cce3f0;">
              <div class="row">
                <div class="col col-3">
                  <img src="img/user.png" alt="Onsen UI" style="width: 120%">
                </div>
                <div class="col col-9">

                  <div class="title">
                    <div class="container">
                      <div class="row">

                        <p style="font-size: 16px">รหัสร้าน :</p>
                        <p style="font-size: 16px" id="codestore"> </p>
                      </div>

                    </div>


                    <p style="font-size: 16px" id="namestore"></p>
                    <p style="font-size: 12px; font-style: normal" id="addressstore">
                      <p>
                  </div>
                </div>
              </div>
            </ons-card>
            <ons-list-item>
              <div class="center" style="font-size: 12px;">สถานะร้าน &nbsp;</div>
              <div class="right">Close &nbsp;
                <ons-switch checked></ons-switch>&nbsp;Open
                <script>
                  function status() {
                    document.querySelector('ons-switch').addEventListener('change', function () {
                      var namestore_get = localStorage.getItem("namestore");
                      if (event.value == true) {

                        var firestoreRef = firestore.collection("Technicians").doc(namestore_get)
                        var updateStatus = firestoreRef.update({
                          status: "on"

                        });
                        console.log(' on ');

                        notifyFix();
                      } else {
                        var firestoreRef = firestore.collection("Technicians").doc(namestore_get)
                        var updateStatus = firestoreRef.update({
                          status: "off"
                        });
                        console.log(' off ');
                      }
                    })
                  }

                  status();

                  function notifyFix() {
                    var namestore_requert = localStorage.getItem("namestore");

                    firestore.collection("requestFix").where("namestore", "==", namestore_requert)
                      .onSnapshot(function (snapshot) {
                        snapshot.docChanges().forEach(function (change) {
                          if (change.type === "added" && change.doc.data().accept == 0) {
                            console.log("Added added requestFix: ", change.doc.data());
                            localStorage.setItem('FixID', change.doc.data().fixID);
                            // createAlertDialog();
                          }
                          if (change.type === "modified" && change.doc.data().accept == 0 && change.doc.data().request == 1) {
                            console.log("Modified modified requestFix: ", change.doc.data());
                            console.log("change.doc.data() ==>" + change.doc.data().accept);
                            var accept = change.doc.data().accept;
                            console.log("Added added requestFix: ", change.doc.data());
                            localStorage.setItem('FixID', change.doc.data().fixID);
                            createAlertDialog();
                          }
                          if (change.type === "removed") {
                            console.log("Removed removed requestFix: ", change.doc.data());
                          }
                        });
                      })


                    // .then(function (docRef) {
                    //   console.log("requestFix  "+docRef.id+" success");

                    //   });
                  }





                </script>
              </div>
            </ons-list-item>
            </div>

          </ons-card>
          <button class="btn btn-primary btn-md send" onclick="reviewcencle()">Send</button>
          <button class="btn btn-primary btn-md send" onclick="casefix()">test</button>
          <script>
          function reviewcencle() {
            document.querySelector('#myNavigator1').pushPage('review.html');
          }
          function casefix() {
            document.querySelector('#myNavigator1').pushPage('casefix.html');
          }

          </script>
        </ons-page>
      </template>

    </ons-page>

  
  </template>
  <template id="review.html">
    <ons-page id="review">
      <ons-toolbar style="background-color: #ffb700">
        <div class="left">
          <ons-back-button>Back</ons-back-button>
        </div>
        <div id="namestorechat" class="center" >ปฏิเสธการเรียกซ่อม</div>
       
      </ons-toolbar>
      <div style="margin: 50px auto 5px; text-align: center; font-size: 20px;">ทำไมถึงปฏเสธการซ่อม ?</div>

    <ons-row class="user_cover">
      <ons-col onclick="sentreview('ลูกค้าหน้าร้านเยอะ')" class="colreview">
        <div class="user_thumbnail" style="background-color: #dd6218"> </ons-icon></div>
        <div class="username" id="review1">ลูกค้าหน้าร้านเยอะ</div>
      </ons-col>
      <ons-col onclick="sentreview('ระยะทางไกลเกินไป')"  class="colreview">
        <div class="user_thumbnail" style="background-color: #00a899"></ons-icon></div>
        <div class="username" id="">ระยะทางไกลเกินไป</div>
      </ons-col>
    </ons-row>
    <ons-row class="user_cover">
      <ons-col onclick="sentreview('ติดรายการซ่อมอื่น')"  class="colreview">
        <div class="user_thumbnail" style="background-color: #e3aa05"></ons-icon></div>
        <div class="username" id="">ติดรายการซ่อมอื่น</div>
      </ons-col>
      <ons-col onclick="sentreview('อื่นๆ')"  class="colreview">
        <div class="user_thumbnail" style="background-color: #94b052;"> </ons-icon></div>
        <div class="username" id="">อื่นๆ</div>
      </ons-col>
    </ons-row>
   <script>
   function sentreview(textrw) {
     var txrw = textrw;
     alert(txrw);
   }
   </script>

    <style type="text/css">
      .user_cover {
        padding: 0px 40px;
        margin: 20px 0px;
      }

      .colreview{

        margin-top: 20px;
      }

      .username {
        text-align: center;
        color: white;
        width: 100%;
        font-size:15px;
        margin-top: -70px;
        
        color: black;
      }

      .user_thumbnail {
        width: 130px;
        height: 120px;
        display: table;
        text-align: center;
        margin-top: 20px;
      }

      .user_thumbnail ons-icon {
        font-size: 70px;
        display: table-cell;
        vertical-align: middle;
      }
    </style>
    </ons-page>
  </template>

  <template id="alert-dialog.html">
    <ons-alert-dialog id="my-alert-dialog" modifier="rowfooter">
      <div class="alert-dialog-title">มีรายการ เรียกซ่อม !!! </div>
      <div class="alert-dialog-content">
        กด "รับซ่อม" เมื่อมีการตกลงเรียกซ่อม
      </div>
      <div class="alert-dialog-footer">
        <ons-alert-dialog-button onclick="cancelFix()">ปฏิเสธ</ons-alert-dialog-button>
        <ons-alert-dialog-button onclick="acceptFix()">รับซ่อม</ons-alert-dialog-button>
      </div>
    </ons-alert-dialog>
  </template>

  <script>
    var createAlertDialog = function () {
      var dialog = document.getElementById('my-alert-dialog');
      if (dialog) {
        dialog.show();
      } else {
        ons.createElement('alert-dialog.html', { append: true })
          .then(function (dialog) {
            dialog.show();
          });
      }
    };

    var hideAlertDialog = function () {

      document.getElementById('my-alert-dialog').hide();
      myNavFunc();

    };

    function acceptFix() {
      var DocFix = localStorage.getItem("FixID");
      firestore.collection("requestFix").doc(DocFix).update({
        accept: 1,
        request: 0,
        done: 1

      }).then(function () {
        console.log("Accept Fix successfully !");
        // document.getElementById('my-alert-dialog').hide();  

        // document.getElementById('my-alert-dialog').hide();
        myNavFunc();

      });

      // myNavFunc();
    }

    function cancelFix() {
      var DocFix = localStorage.getItem("FixID");
      firestore.collection("requestFix").doc(DocFix).update({
        accept: 2,
        request: 2,
        done: 0

      })
        .then(function () {
          console.log("cancel Fix successfully !");
          document.getElementById('my-alert-dialog').hide();
          document.querySelector('#myNavigator1').pushPage('review.html');

        });
    }

    function myNavFunc() {
      // document.getElementById('my-alert-dialog').hide();
      document.getElementById('my-alert-dialog').hide();
      var long = 98.3370182;
      var lat = 7.8947922;
      // If it's an iPhone..
      if ((navigator.platform.indexOf("iPhone") != -1)
        || (navigator.platform.indexOf("iPod") != -1)
        || (navigator.platform.indexOf("iPad") != -1)
        || (navigator.platform.indexOf("Android") != -1))
        window.open('maps://maps.google.com/maps?daddr=' + lat + ',' + long + '&amp;ll=');
      else
        window.open('http://maps.google.com/maps?daddr=' + lat + ',' + long + '&amp;ll=');
    }

  </script>
  <!--  ======================================================tab1===================================================== -->

  <!--  ======================================================tab2===================================================== -->
  <template id="tab2.html">
    <ons-page id="Tab2">

      <ons-toolbar>
        <div class="center">
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <ons-segment id="segment" tabbar-id="tabbar" style="width: 300px; ">
            <button style="font-family: 'Pridi', serif; color: orange;" >กำลังทำการซ่อม</button>
            <button style="font-family: 'Pridi', serif; color: green;">ซ่อมเสร็จ</button>
            <button style="font-family: 'Pridi', serif; color: blue;">รีวิวการซ่อม</button>
          </ons-segment>
        </div>


      </ons-toolbar>
      <ons-tabbar id="tabbar">
        <ons-tab page="page1.html" active></ons-tab>
        <ons-tab page="page2.html"></ons-tab>
        <ons-tab page="page3.html"></ons-tab>
      </ons-tabbar>

      <template id="page1.html">
        <ons-page>
          <ons-list-header id="timenotify"></ons-list-header>
          <script>
            var date = new Date();
            document.getElementById("timenotify").innerHTML = date.getDate() + "/" + date.getMonth() + "/" + date.getFullYear() + "::" + date.toLocaleTimeString();

          </script>
          <div id="showdoingfixlist">

          </div>

          <script>

            var showAlert = function () {
             
              var DocFix = localStorage.getItem("FixID");
              var d = new Date().toLocaleString();
              d = d.split(' ').slice(0, 5).join(' ');
              firestore.collection("requestFix").doc(DocFix).update({
                accept: 1,
                request: 0,
                done: 2,
                timefixdone: d
              }).then(function () {
                  console.log("Accept Fix done !");
               
                  // window.location.reload(true);
                  document.querySelector('#myNavigator1').pushPage('casefix.html');
        
                  // document.getElementById('my-alert-dialog').hide();
              
                
                });

            };

            function showListDoingFix() {
              var namestore_requert = localStorage.getItem("namestore");

              firestore.collection("requestFix").where("namestore", "==", namestore_requert)
                .onSnapshot(function (snapshot) {
                  snapshot.docChanges().forEach(function (change) {

                    if (change.doc.data().accept == 1 && change.doc.data().request == 0 && change.doc.data().done == 1) {
                      console.log("Modified modified requestFix: ", change.doc.data());
                      localStorage.setItem('customer', change.doc.data().customer)
                      var fixidlist = change.doc.data().fixID
                      var fixlist = fixidlist.slice(0, 8);
                      $('#showdoingfixlist').append(

                        '<ons-card>' +
                        '<div class="container">' +
                        '<div class="row">' +
                        '<div class="col-8">' +
                        '<div class="col" id="" style="font-size: 15px;margin-left:-20px ;"> <i class="fas fa-tools" style="color: coral" ></i> รายการซ่อม :' + fixlist + '</div>' +

                        '</div>' +
                        ' <div class="col-4">' +
                        '<center>' +
                        '<a href="tel:0993044146"> <button type="button" class="btn btn-outline-success"> <i class="fa fa-phone" onclick=""></i>&nbsp</button></a>' +

                        '<button type="button" class="btn btn-outline-warning " id="chatclick"><i class="fa fa-comment" onclick="chat()"></i></button>' +
                        '</center>' +
                        ' </div>' +
                        '</div>' +
                        '<div class="row">' +
                        '<div class="col">' +

                        '<div  style="font-size: 13px;margin-top:-10px" >ซ่อมให้ :' + change.doc.data().customer + ' </div>' +
                        '<div style="font-size: 12px ">สถานะ : กำลังดำเนินการซ่อม' + '</div>' +
                        '<p style="font-size: 8pt; margin-top: 7px; "> เวลา : ' + change.doc.data().date + ' </p>' +
                        '</div>' +

                        '</div>' +
                        '</div>' +

                        ' <br>' +
                        ' <button type="button" class="btn btn-success btn-lg" onclick="showAlert()"><i class="fa fa-check"></i></button>' +
                        ' </ons-card>'

                      )

                    }

                  });
                })

            }
            showListDoingFix();
          </script>

          <template id="chat.html">
            <ons-page id="test2">

              <ons-toolbar style="background-color: #ffb700">
                <div class="left">
                  <ons-back-button>Back</ons-back-button>
                </div>
                <div id="customerchat" class="center"></div>
                <script>
                  var customerchat = localStorage.getItem("customer");
                  document.getElementById('customerchat').innerHTML = customerchat;
                </script>
              </ons-toolbar>
              <div class="col-sm-3 col-sm-offset-4 frame">
                <ul id="showmessages"></ul>

                <div>
                  <div class="msj-rta macro1">
                    <div class="text text-r" style="background:whitesmoke !important">
                      <input id="mytext" class="mytext" placeholder="Type a message" />
                    </div>
                  </div>
                  <div style="padding:10px;">
                    <!-- <span class="glyphicon glyphicon-share-alt"></span> -->
                    <span class="input-group-btn">
                      <button class="btn btn-primary btn-md send" id="btn-chat">Send</button>
                    </span>
                  </div>
                </div>

              </div>
              <!-- style chat  -->
              <style>
                .mytext {

                  border: 0;
                  padding: 5px 5px 5px 5px;
                  font-size: 15px;
                  background: whitesmoke;
                }

                .text {
                  width: 75%;
                  display: flex;
                  flex-direction: column;
                }

                .text>p:first-of-type {
                  width: 100%;
                  margin-top: 5px;
                  margin-bottom: auto;
                  line-height: 20px;
                  font-size: 20px;
                }

                .text>p:last-of-type {
                  width: 100%;
                  text-align: right;
                  color: silver;
                  margin-bottom: -7px;
                  margin-top: auto;
                }

                .text-l {
                  float: left;
                  padding-right: 10px;
                }

                .text-r {
                  float: right;
                  padding-left: 10px;
                }

                .avatar {
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  width: 25%;
                  float: left;
                  padding-right: 10px;
                }

                .macro {
                  margin-top: 10px;
                  width: 85%;
                  border-radius: 5px;
                  padding: 5px;

                  display: flex;
                }

                .macro1 {
                  margin-top: 10px;
                  margin-left: 5px;
                  width: 85%;
                  height: 60%;

                  padding: 5px 5px 5px 5px;
                  border-radius: 15px 15px 15px 15px !important;
                  border-top: 0 !important;

                  display: flex;
                }

                .msj-rta {
                  float: right;
                  background: whitesmoke;
                }

                .msj {
                  float: left;
                  background: white;
                }

                .frame {
                  background: #e0e0de;
                  height: 100%;
                  overflow: hidden;
                  padding: 0;
                }

                .frame>div:last-of-type {
                  position: absolute;
                  bottom: 0;
                  width: 100%;
                  height: 70px;
                  display: flex;
                }

                body>div>div>div:nth-child(2)>span {
                  background: whitesmoke;
                  padding: 10px;
                  font-size: 21px;
                  border-radius: 50%;
                }

                body>div>div>div.msj-rta.macro {
                  margin: auto;
                  margin-left: 1%;
                }

                ul {
                  width: 100%;
                  list-style-type: none;
                  padding: 18px;
                  position: absolute;
                  bottom: 47px;
                  display: flex;
                  flex-direction: column;
                  top: 0;
                  overflow-y: scroll;
                }

                .msj:before {
                  width: 0;
                  height: 0;
                  content: "";
                  top: -5px;
                  left: -14px;
                  position: relative;
                  border-style: solid;
                  border-width: 0 13px 13px 0;
                  border-color: transparent #ffffff transparent transparent;
                }

                .msj-rta:after {
                  width: 0;
                  height: 0;
                  content: "";
                  top: -5px;
                  left: 14px;
                  position: relative;
                  border-style: solid;
                  border-width: 13px 13px 0 0;
                  border-color: whitesmoke transparent transparent transparent;
                }

                input:focus {
                  outline: none;
                }

                ::-webkit-input-placeholder {
                  /* Chrome/Opera/Safari */
                  color: #d4d4d4;
                }

                ::-moz-placeholder {
                  /* Firefox 19+ */
                  color: #d4d4d4;
                }

                :-ms-input-placeholder {
                  /* IE 10+ */
                  color: #d4d4d4;
                }

                :-moz-placeholder {
                  /* Firefox 18- */
                  color: #d4d4d4;
                }
              </style>
              <!-- script chat  -->
              <script>

                var me = {};
                me.avatar = "img/man.png";
                var you = {};
                you.avatar = "img/boy.png";

                function loadMessage() {
                  var FixID = localStorage.getItem("FixID");
                  var displayNamechat = localStorage.getItem("namestore");
                  var query = firestore.collection('messages').doc(FixID).collection('msg').orderBy('timestamp', 'asc').limit(12);
                  console.log("query" + query);
                  query.onSnapshot(function (snapshot) {
                    snapshot.docChanges().forEach(function (change) {
                      if (change.type === 'removed') {

                      } if (change.type === "added") {
                        var text = change.doc.data().text;
                        var datetime = change.doc.data().dateTime;

                        var who;
                        if (change.doc.data().who == displayNamechat) {
                          who = "me";
                        }
                        if (who == "me") {

                          $('#showmessages').append(
                            '<li style="width:100%;">' +
                            '<div class="msj-rta macro">' +
                            '<div class="text text-r">' +
                            '<p>' + text + '</p>' +
                            '<p style="font-size:15px"><small id="date">' + datetime + '</small></p>' +
                            '</div>' +
                            '<div class="avatar" style="padding:0px 0px 0px 10px !important"><img class="img-circle" style="width:100%;" src="' + me.avatar + '" /></div>' +
                            '</li>').scrollTop('#showmessages').prop('scrollHeight')

                        } else {

                          you.avatar = change.doc.data().pic;
                          $('#showmessages').append(
                            '<li style="width:100%">' +
                            '<div class="msj macro">' +
                            '<div class="avatar"><img class="img-circle" style="width:100%;" src="' + you.avatar + '" /></div>' +
                            '<div class="text text-l">' +
                            '<p>' + text + '</p>' +
                            '<p style="font-size:15px"><small >' + datetime + '</small></p>' +
                            '</div>' +
                            '</div>' +
                            '</li>').scrollTop('#showmessages').prop('scrollHeight')

                        }


                      }

                    });
                  });

                }

                document.getElementById("btn-chat").addEventListener("click", function () {
                  var messenger = document.getElementById("mytext").value;


                  console.log("messenger::" + messenger);
                  if (messenger !== "") {
                    var FixID = localStorage.getItem("FixID");
                    var namestorechat = localStorage.getItem("namestore");
                    var d = new Date().toLocaleString();
                    d = d.split(' ').slice(0, 5).join(' ');
                    firebase.firestore().collection('messages').doc(FixID).collection('msg').add({
                      text: messenger,
                      timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                      dateTime: d,
                      who: namestorechat


                    }).catch(function (error) {
                      console.error('Error writing new message to Firebase Database', error);
                    });
                    document.getElementById("mytext").value = '';

                  }

                });

                // $('body > div > div > div:nth-child(2) > span').click(function () {
                //   $(".mytext").trigger({ type: 'keydown', which: 13, keyCode: 13 });
                // })

                //-- Clear Chat
                // resetChat();





                loadMessage();
              </script>
            </ons-page>
          </template>

        </ons-page>

      </template>

      <template id="page2.html">
        <ons-page>

          <div id="showdonefixlist"> </div>


          <script>
function showListDoneFix() {
      var namestore_requert = localStorage.getItem("namestore");
      

      firestore.collection("requestFix").where("namestore", "==", namestore_requert)
        .onSnapshot(function (snapshot) {
          snapshot.docChanges().forEach(function (change) {

            if (change.doc.data().accept == 1 && change.doc.data().request == 0 && change.doc.data().done == 2) {
              console.log("Modified modified requestFix: ", change.doc.data());
              var fixidlist = change.doc.data().fixID
              var fixlist = fixidlist.slice(0, 8);
              $('#showdonefixlist').append(

                '<ons-card>' +
                '<div class="col-12" id="" style="font-size: 17px"> <i class="far fa-check-circle" style="color: green;"></i> รายการซ่อม : ' + fixlist + '</div>' +
                '<div  style="font-size: 15px;margin-left: 30px;" >ซ่อมให้ :' + change.doc.data().customer + ' <div>' +
                '<div style="font-size: 15px">สถานะ : ซ่อมเสร็จเรียบร้อย<div>' +
                '<p style="font-size: 8pt; margin-top: 7px; "> เวลา : ' + change.doc.data().timefixdone + ' </p>' +
                '</div>' +
                '</div>' +
                '</ons-card>'
              )

            }

          });
        })


    }
    showListDoneFix();
          </script>
        </ons-page>
      </template>

      <template id="page3.html">
        <ons-page>
          <ons-card>


            <ons-list-header style="font-size: 25px">Review</ons-list-header>

            <div id="showreview" ></div>

          </ons-card>


          <script>

            var reviewstore = localStorage.getItem("namestore");
            firestore.collection("Technicians").doc(reviewstore).collection("review").where("namestore", "==", reviewstore)
              .onSnapshot(function (snapshot) {
                snapshot.docChanges().forEach(function (change) {

                  if (change.type === 'removed') {

                  } else {
                    console.log("rrrrrr" + change.doc.data().rating);

                    $('#showreview').append(

                      '<div style="margin-top: -10px">' +
                      '<ons-list-item style="font-size: 10pt">' +
                      '<div class="col-2" style="margin-left: -20px;">' +
                      '<img class="list-item__thumbnail" src="https://placekitten.com/g/40/40" style="width: 30px; height: 30px;">' +
                      '</div>' +
                      '<div class="col-6" style="margin-left: -10px;">' +
                      '<span class="list-item__title" style=" font-size: 8pt;">' + change.doc.data().customer + '</span>' +
                      ' </div>' +
                      ' <div class="col-4" style="margin-right: -10px;">' +
                      '<span class="float-right"><i class="text-warning fa fa-star"></i></span>' +
                      '<span class="float-right"><i class="text-warning fa fa-star"></i></span>' +
                      '<span class="float-right"><i class="text-warning fa fa-star"></i></span>' +
                      '<span class="float-right"><i class="text-warning fa fa-star"></i></span>' +
                      ' </div>' +
                      ' <div class="col-12">' +
                      '<p style="font-size: 12pt; margin-top: 8px;margin-left: 22px"">' + change.doc.data().reviewtext + ' </p>' +
                      '</div>' +
                      ' <div>' +
                      '<p style="font-size: 6pt; margin-top: -12px; margin-left: 22px">' +
                      '29/11/2562 12:05 | รายการซ่อม : fgdgdfg75757' +
                      '  </p>' +

                      '  </div>' +
                      '</ons-list-item>' +
                       
                      ' </div>'

                    )
                  }

                });
              });
          </script>
        </ons-page>
      </template>

    </ons-page>

  </template>

  <template id="casefix.html">
    <ons-page id="casefix">
      <ons-toolbar style="background-color: #ffb700">
        <div class="left">
          <ons-back-button>Back</ons-back-button>
        </div>
        <div id="namestorechat" class="center" >สาเหตุการซ่อมของลูกค้า</div>
       
      </ons-toolbar>
      <div style="margin: 50px auto 5px; text-align: center; font-size: 20px;">รายการซ่อมเป็นอย่างไรบ้าง ?</div>
      <ons-card style="font-size: 16px;">
        <form action="">
          <div class="spancus"><span>ลูกค้า : </span></div>
          <div class="spancase"><span>สาเหตุ : </span></div>
          <br>
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="exampleCheck1">
            <label class="form-check-label" for="exampleCheck1">รถยางแบน</label>
          </div>
          <div class="form-check">
            <input type="checkbox" class="form-check-input" id="exampleCheck2">
            <label class="form-check-label" for="exampleCheck2">รถยางแบน</label>
          </div>
          <div class="form-group">
            <span>อื่นๆ : </span> <textarea class="form-control" id="exampleFormControlTextarea1" rows="2"></textarea>
          </div>
          <button type="button" class="btn btn-success btn-lg" style="margin-left: 270px;" onclick="goReview()">ยืนยัน</button>
        </form>
      </ons-card>
   <script>
  

  function DoneFix() {
   
              var FixIDrw = localStorage.getItem("FixID");

              firestore.collection("requestFix").where("fixID", "==", FixIDrw)
                .onSnapshot(function (snapshot) {
                  snapshot.docChanges().forEach(function (change) {
                    if (change.type === "removed") {

                    } else {

                    if (FixIDrw == change.doc.data().fixID && change.doc.data().done == 2) {
              
                        getReview();

                        localStorage.removeItem('FixID');

                      };

                    }

                  });
                })

            }

            function goReview() {
              
              window.location.reload(true);
}


            
   </script>

    <style type="text/css">
      .user_cover {
        padding: 0px 40px;
        margin: 20px 0px;
      }

      .colreview{

        margin-top: 20px;
      }

      .username {
        text-align: center;
        color: white;
        width: 100%;
        font-size:15px;
        margin-top: -70px;
        
        color: black;
      }

      .user_thumbnail {
        width: 130px;
        height: 120px;
        display: table;
        text-align: center;
        margin-top: 20px;
      }

      .user_thumbnail ons-icon {
        font-size: 70px;
        display: table-cell;
        vertical-align: middle;
      }
    </style>
    </ons-page>
  </template>
  <!--  ======================================================tab2===================================================== -->

  <!--  ======================================================tab3===================================================== -->
  <template id="tab3.html">
    <ons-page id="Tab3">
      <ons-navigator swipeable id="myNaviTap4" page="setting.html"></ons-navigator>
      <template id="setting.html">
        <ons-page id="setting">
          <ons-card>
            <center>
              <button type="button" class="btn btn-outline-secondary"
                style="margin-left: 210px; width: 110px;height: 40px;font-size: 12px;" onclick="editprofile()">Edit
                Profile <i class="fas fa-edit"></i></button>
              <div id="profile-pic">
              </div>
              </div>
              <div id="displayname" style="font-size: 25px">

              </div>
            </center>
            <script>


              document.getElementById("displayname").innerHTML = localStorage.getItem("namestore");

              var img = document.createElement('img');
              img.src = "img/man.png";
              img.style = "width: 35%";
              document.getElementById('profile-pic').appendChild(img);
            </script>
          </ons-card>
          <!-- //crad profile -->

          <!-- card setting -->
          <ons-card>
            <div class="content">
              <ons-list>
                <ons-list-header>Setttings</ons-list-header>
                <ons-list-item id="push-page">Help & Support<i class="large material-icons">chevron_right</i>
                </ons-list-item>
                <ons-list-item id="push-page2">Contact Us<i class="large material-icons">chevron_right</i>
                </ons-list-item>
                <ons-list-item id="push-page3">Terms & Conditions<i class="large material-icons">chevron_right</i>
                </ons-list-item>
              </ons-list>

            </div>
          </ons-card>
          <!-- //card setting -->

        </ons-page>
      </template>
      <!--editprofile -->

      <template id="editprofile.html">
        <ons-page id="editprofile">
          <ons-toolbar style="background-color: #ffb700">
            <div class="left">
              <ons-back-button>Back</ons-back-button>
            </div>
            <div class="center">Edit Profile</div>
            <div class="right"></div>
          </ons-toolbar>
          <ons-card>
            <div class="cover" style="font-size: 18px;">รูปโปรไฟล์ </div>
            <center>
              <div>
                <!-- <img src="img/user.png" alt="" style="width: 50%;height: 50%;"> -->
                <div>
                  <img id="image" style="display:none; width:210px;height:210px;  border-radius: 50%;" src="" />
                </div>
              </div>
            </center>
            <center>

              <div class="col">
                <button type="button" class="btn btn-outline-primary" onclick="getPhotoFromCamera()">Camera</button>
                <button type="button" class="btn btn-outline-primary" onclick="getPhotoFromAlbum()">album</button>
              </div>

            </center>
            <script>
              var Picture;
              var StoreImage = localStorage.getItem('namestore');
              var storageRef = firebase.storage().ref();
              var ref = storageRef.child('StoreImages/' + StoreImage + '.jpg');


              function getPhotoFromCamera() {
                navigator.camera.getPicture(onPhotoDataSuccess, onFail, {
                  quality: 50,
                  sourceType: navigator.camera.PictureSourceType.CAMERA,
                  destinationType: navigator.camera.DestinationType.DATA_URL,
                });
              }
              function onPhotoDataSuccess(imageData) {
                var image = document.getElementById('image');
                image.style.display = 'block';
                image.src = "data:image/jpeg;base64," + imageData;
                Picture = imageData;

              }

              function getPhotoFromAlbum() {
                navigator.camera.getPicture(onPhotoURISuccess, onFail, {
                  quality: 50,
                  sourceType: navigator.camera.PictureSourceType.SAVEDPHOTOALBUM,
                  destinationType: navigator.camera.DestinationType.FILE_URI
                });
              }
              function onPhotoURISuccess(imageURI) {
                var image = document.getElementById('image');
                image.style.display = 'block';
                image.src = imageURI;
                Picture = imageURI;


              }
              function onFail(message) {
                alert('Failed because:' + message);
              }


              function saveStoreImage() {
                var message = Picture;
                var url;
                ref.putString(message, 'base64').then(function (snapshot) {
                  console.log('Uploaded a base64 string!');
                  snapshot.ref.getDownloadURL().then(function (downloadURL) {
                    console.log("File available at", downloadURL);
                    url = downloadURL;
                    console.log("url" + url);

                  })
                })
              }
            </script>
          </ons-card>

          <ons-card>
            <div class="photo"></div>

            <div class="editnameuser">
              <ons-list>
                <ons-list-item id="push-page4" style="font-size: 16px;">ชื่อร้าน<i
                    class="large material-icons">chevron_right</i>
                </ons-list-item>
                <ons-list-item id="push-page5" style="font-size: 16px;">ชื่อช่างซ่อม<i
                    class="large material-icons">chevron_right</i>
                </ons-list-item>
                <ons-list-item id="push-page8" style="font-size: 16px;">ที่อยู่ร้าน<i
                    class="large material-icons">chevron_right</i>
                </ons-list-item>
                <ons-list-item id="push-page6" style="font-size: 16px;">เบอร์โทรศัพท์<i
                    class="large material-icons">chevron_right</i>
                </ons-list-item>
                <ons-list-item id="push-page7" style="font-size: 16px;">ตั้งรหัสผ่าน<i
                    class="large material-icons">chevron_right</i>
                </ons-list-item>
              </ons-list>
            </div>
          </ons-card>

          <!--editname-->
          <template id="editNameStore.html">
            <ons-page id="editName">
              <ons-toolbar style="background-color: #ffb700">
                <div class="left">
                  <ons-back-button>Back</ons-back-button>
                </div>
                <div class="center">FIX IT</div>
              </ons-toolbar>
            </ons-page>
          </template>

          <!--editusername-->
          <template id="editusername.html">
            <ons-page id="editusername">
              <ons-toolbar style="background-color: #ffb700">
                <div class="left">
                  <ons-back-button>Back</ons-back-button>
                </div>
                <div class="center">FIX IT</div>
              </ons-toolbar>
            </ons-page>
          </template>

          <!--edittel-->
          <template id="edittel.html">
            <ons-page id="edittel">
              <ons-toolbar style="background-color: #ffb700">
                <div class="left">
                  <ons-back-button>Back</ons-back-button>
                </div>
                <div class="center">FIX IT</div>
              </ons-toolbar>
            </ons-page>
          </template>

          <!--editpassword-->
          <template id="editpass.html">
            <ons-page id="editpass">
              <ons-toolbar style="background-color: #ffb700">
                <div class="left">
                  <ons-back-button>Back</ons-back-button>
                </div>
                <div class="center">FIX IT</div>
                <div class="right"><i class="fas fa-check"
                    style="font-size: medium; margin-right: 10px; margin-bottom: 5px;"></i></div>
              </ons-toolbar>
              <div id="bg-page"
                style="background-image: url('https://www.toptal.com/designers/subtlepatterns/patterns/concrete-texture.png');height: 88vh;width: auto;">
                <form action="">
                  <div class="form-group">
                    <div class="form-row">
                      <div class="col-md-3 mb-3">
                        <center><input style="margin-top: 20px; width: 80%;" type="text" class="form-control" id=""
                            aria-describedby="" placeholder="กรอกรหัสผ่านเดิม"></center>
                      </div>
                      <div class="col-md-3 mb-3">
                        <center><input style="width: 80%;" type="text" class="form-control" id="" aria-describedby=""
                            placeholder="กรอกรหัสผ่านใหม่"></center>
                      </div>

                    </div>

                  </div>
            </ons-page>
          </template>

          <!--editlocation-->
          <template id="editlocation.html">
            <ons-page id="editlocation">
              <ons-toolbar style="background-color: #ffb700">
                <div class="left">
                  <ons-back-button>Back</ons-back-button>
                </div>
                <div class="center">FIX IT</div>
                <div class="right"><i class="fas fa-check"
                    style="font-size: medium; margin-right: 10px; margin-bottom: 5px;"></i></div>
              </ons-toolbar>
              <div id="bg-page"
                style="background-image: url('https://www.toptal.com/designers/subtlepatterns/patterns/concrete-texture.png');height: 88vh;width: auto;">
                <form action="">
                  <div class="form-group">
                    <div class="form-row">
                      <div class="col-md-3 mb-3">
                        <center><textarea class="form-control" id="exampleFormControlTextarea1" rows="5"
                            placeholder="กรอกที่อยู่" style="margin-top: 20px; width: 80%;"></textarea></center>
                      </div>
                    </div>

                  </div>
            </ons-page>
          </template>




          <style type="text/css">
            .camera-view {
              width: 100%;
              height: 60%;
              text-align: center;
              background-color: #cacaca;
              display: table;
            }

            .camera-icon {
              vertical-align: middle !important;
              font-size: 100px;
              opacity: 0.4;
              display: table-cell;
            }

            .camera-button {
              width: 100%;
              height: 40%;
              text-align: center;
              display: table;
            }
          </style>
          <!-- <ons-card>
        <div>
          <center style="font-size: 14pt">Terms Conditions</center>
        </div>
        <div style="margin: 20px 20px 20px 20px">
          <p style="font-size: 10pt"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
           Edit Profilr</p>

          <p style="font-size: 10pt"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; คุณจำเป็นต้องลงทะเบียน
            เพื่อเข้าใช้งาน FIXINGMAN APP เพื่อเปิดใช้งานบัญชีของคุณ
            ในกระบวนการดำเนินการเราจำเป็นต้องเก็บรวบรวมข้อมูลส่วนบุคคลต่อไปนี้
            - DATA : ชื่อผู้ใช้ , ชื่อร้านซ่อม , หมายเลขบัตรประชาชน , อีเมล , เบอร์โทรศัพท์ ,
            พิกัดที่ใช้บอกตำแหน่งบนพื้นโลก
          </p>

          <p style="font-size: 10pt"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ในระหว่างที่ใช้ FIXINGMAN APP
            ทางผู้พัฒนาขอสงวนสิทธิ์ในการเก็บรวบรวมข้อมูลการติดต่อรวมทั้งข้อมูลการจัดส่งรายการเมื่อคุณติดต่อเรา
            เมื่อคุณใช้บริการของเรา ข้อมูลเกี่ยวกับเครือข่ายของคุณ ( ที่อยู่ IP ,การเก็บข้อมูลที่อยู่ของ IP,
            ประเภทของเครือข่าย , ฯลฯ) , บันทึกการใช้บริการ (ความถี่ในการใช้ , การใช้เหรียญ , ฯลฯ ) ,
            ข้อมูลของอุปกรณ์ (รุ่น , ระบบปฏิบัติการ , ฯลฯ) อาจถูกเก็บรวบรวม
            วิธีการเก็บข้อมูลส่วนบุคคล</p>
        </div>
      </ons-card> -->

        </ons-page>
      </template>
      <style>
        .user-profile .user-profile-card {
          position: relative;
          padding-top: 0;
          overflow: hidden;
        }

        .user-profile-card .user-profile-header {
          background: url("http://lorempixel.com/850/280/nature/4/");
          background-size: cover;
          height: 135px;
          width: auto;
        }

        .user-profile-card .user-profile-avatar {
          position: relative;
          top: -100px;
          margin-bottom: -100px;
          padding: 0 15px;
        }

        .user-profile-card .user-profile-avatar img {
          width: auto;
          height: 200px;
          -webkit-border-radius: 50%;
          -moz-border-radius: 50%;
          border-radius: 50%;
          border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .user-profile {
          display: block;
          line-height: 1.428571429;
          color: #999;
          position: relative;
        }
      </style>

      <!--Help-->
      <template id="help.html">
        <ons-page id="help">
          <ons-toolbar style="background-color: #ffb700">
            <div class="left">
              <ons-back-button>Back</ons-back-button>
            </div>
            <div class="center"></div>
          </ons-toolbar>
          <ons-card>
            <center style="font-size: 14pt">Help & Support</center>
            <div style="margin-top: 20px">
              <ons-list-header>บริการ</ons-list-header>
              <ons-list-item expandable style="font-size: 10pt">
                FIX IT APP คืออะไร
                <div class="expandable-content">
                  <p>
                    FIX IT คือแอพที่ใช้เพื่อเรียกขอรับบริการซ่อมรถนอกสถานที่จากช่างซ่อม
                    เพื่อความสะดวกสบายแก่ผู้ขับขี่รถจักรยานยนต์
                  </p>
                </div>
              </ons-list-item>

              <ons-list-item expandable style="font-size: 10pt">
                เหรียญ คืออะไร
                <div class="expandable-content">
                  <p>
                    เหรียญ คือสิ่งที่ใช้นำมาแลกเพื่อเป็นส่วนลดตอนจ่ายเงินเมื่อช่างทำการซ่อมเสร็จสิ้น
                  </p>
                </div>
            </div>
            </ons-list-item>

          </ons-card>
        </ons-page>
      </template>

      <!--ContactUs-->
      <template id="contactUs.html">
        <ons-page id="contactUs">
          <ons-toolbar style="background-color: #ffb700">
            <div class="left">
              <ons-back-button>Back</ons-back-button>
            </div>
            <div class="center"></div>
          </ons-toolbar>
          <ons-card>
            <center style="font-size: 14pt">Contact Us</center>
            <div style="margin: 20px 20px 20px 20px">
              <center><img src="img/PSU.png" alt="PSU Logo" width="20%" style="margin-bottom: 20px"></center>

              <center>
                <div class="expandable-content" style="font-size: 10pt">
                  <p>แอพพลิเคชันนี้ถูกสร้างขึ้นเป็นส่วนหนึ่งของรายวิชา PROJECT IN SE รหัส 977-491 ภาคเรียนที่ 1/2562</p>
                  <ons-list-item>
                    <div class="left">
                      <img class="list-item__thumbnail"
                        src="https://scontent.fbkk10-1.fna.fbcdn.net/v/t1.0-9/65922349_1191144487754729_3530931659589287936_n.jpg?_nc_cat=110&_nc_eui2=AeFho7yvr8pZo8AlEwL9dcvfhd-1OxetRMx7oFE0mWXmlHrCZkK7ZdBq8qB8NVBogucYMruQEPhuyOI00dH8mlddiDgPLxdKqkYdJ9QpJKyl7Q&_nc_oc=AQk78TfxbNHxapUSZjLErT-Wy2f4kLvqiHDGvK-Etd_RWjLjUjJd3qvkmydPwOSqqEA&_nc_ht=scontent.fbkk10-1.fna&oh=5538976aa36edee38f0c6c93fa3dce95&oe=5E3779C8">
                    </div>
                    <div class="center">
                      <span class="list-item__title">นางสาวณัฐวราภรณ์ ทับเที่ยง</span><span
                        class="list-item__subtitle">ผู้จัดทำโปรเจค</span>
                    </div>
                  </ons-list-item>
                  <ons-list-item>
                    <div class="left">
                      <img class="list-item__thumbnail"
                        src="https://scontent.fbkk14-1.fna.fbcdn.net/v/t1.0-9/20708438_915003475314188_731298591761034821_n.jpg?_nc_cat=106&_nc_eui2=AeGWtujPwqrrR96MdDoR1Ry8T7XzQLbJqep5Iq4L2BTxTRBoXvkn4lMZc2pebtjw_uXDx5R7X6NOuj4sWlmYJA5bdYAvMRGhNkkcs5l9b6p8Iw&_nc_oc=AQn3gN1oEYFhYsFwwnOMjYPZvMcwMsm8HTs_fMsSpbTb5jm5XWSCfiy5VtupafHdMv4&_nc_ht=scontent.fbkk14-1.fna&oh=9f038e0b777651d4c634abc83d80cece&oe=5E3D2EAC">
                    </div>
                    <div class="center">
                      <span class="list-item__title">นายพีระนันท์ เรียนมาแทน</span><span
                        class="list-item__subtitle">ผู้จัดทำโปรเจค</span>
                    </div>
                  </ons-list-item>
                  <ons-list-item>
                    <div class="left">
                      <img class="list-item__thumbnail"
                        src="https://scontent.fbkk14-1.fna.fbcdn.net/v/t1.0-9/44715851_10212714317308327_723654980958945280_n.jpg?_nc_cat=104&_nc_eui2=AeEdkhFqimnC3b0v3hu47_N0TthtthiTo9msc3vMxisrp875VhL38XxMmxjDiGBTtp4gYdD-EF6oZ7jcfzmtMAZKdhoEnj_6QFLfInF-Ywflkg&_nc_oc=AQkjMWIDntTh0RL0wLLR9ijxlSucIQC12yXKC_aDbhl6wm6aPSfgQzcUT04KSqj7DRc&_nc_ht=scontent.fbkk14-1.fna&oh=e58da7d1508825c2a2f2722330484e94&oe=5E2E059D">
                    </div>
                    <div class="center">
                      <span class="list-item__title">ผศ.ดร.อซีส นันทอมรพงศ์</span><span
                        class="list-item__subtitle">อาจารย์ที่ปรึกษาโปรเจค</span>
                    </div>
                  </ons-list-item>
                </div>
              </center>

              <div style="font-size: 14pt ;margin-right: 15px; margin-bottom: 15px; margin-top: 15px"><a
                  href="tel:0980103837">
                  <img src="img/telephone.png" style="width: 30px;"></a>&nbsp;ติดต่อเรา</div>

              <div style="font-size: 14pt;margin-right: 15px; margin-bottom: 15px"><a
                  href="mailto:s5930213012@phuket.psu.ac.th">
                  <img src="img/email.png" style="width: 30px;"></a>&nbsp;Email
              </div>

            </div>

          </ons-card>
        </ons-page>
      </template>

      <!--Terms Conditions-->
      <template id="terms.html">
        <ons-page id="terms">
          <ons-toolbar style="background-color: #ffb700">
            <div class="left">
              <ons-back-button>Back</ons-back-button>
            </div>
            <div class="center"></div>
          </ons-toolbar>
          <ons-card>
            <div>
              <center style="font-size: 14pt">Terms Conditions</center>
            </div>
            <div style="margin: 20px 20px 20px 20px">
              <p style="font-size: 10pt"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                นโยบายความเป็นส่วนตัว
                นโยบายการจัดเก็บข้อมูลส่วนบุคคลของ FIXINGMAN</p>

              <p style="font-size: 10pt"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; คุณจำเป็นต้องลงทะเบียน
                เพื่อเข้าใช้งาน FIXINGMAN APP เพื่อเปิดใช้งานบัญชีของคุณ
                ในกระบวนการดำเนินการเราจำเป็นต้องเก็บรวบรวมข้อมูลส่วนบุคคลต่อไปนี้
                - DATA : ชื่อผู้ใช้ , ชื่อร้านซ่อม , หมายเลขบัตรประชาชน , อีเมล , เบอร์โทรศัพท์ ,
                พิกัดที่ใช้บอกตำแหน่งบนพื้นโลก
              </p>

              <p style="font-size: 10pt"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ในระหว่างที่ใช้ FIXINGMAN APP
                ทางผู้พัฒนาขอสงวนสิทธิ์ในการเก็บรวบรวมข้อมูลการติดต่อรวมทั้งข้อมูลการจัดส่งรายการเมื่อคุณติดต่อเรา
                เมื่อคุณใช้บริการของเรา ข้อมูลเกี่ยวกับเครือข่ายของคุณ ( ที่อยู่ IP ,การเก็บข้อมูลที่อยู่ของ IP,
                ประเภทของเครือข่าย , ฯลฯ) , บันทึกการใช้บริการ (ความถี่ในการใช้ , การใช้เหรียญ , ฯลฯ ) ,
                ข้อมูลของอุปกรณ์ (รุ่น , ระบบปฏิบัติการ , ฯลฯ) อาจถูกเก็บรวบรวม
                วิธีการเก็บข้อมูลส่วนบุคคล</p>
            </div>
          </ons-card>
        </ons-page>
      </template>


    </ons-page>
  </template>

  <script>
    document.addEventListener('init', function (event) {
      var page = event.target;

      if (page.id === 'setting') {
        page.querySelector('#push-page').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('help.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'help') {

        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });

    document.addEventListener('init', function (event) {
      var page = event.target;
      if (page.id === 'setting') {
        page.querySelector('#push-page2').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('contactUs.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'contactUs') {
        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });

    document.addEventListener('init', function (event) {
      var page = event.target;
      if (page.id === 'setting') {
        page.querySelector('#push-page3').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('terms.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'terms') {
        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });

    document.addEventListener('init', function (event) {
      var page = event.target;
      if (page.id === 'editprofile') {
        page.querySelector('#push-page4').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('editNameStore.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'editNameStore') {
        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });

    document.addEventListener('init', function (event) {
      var page = event.target;
      if (page.id === 'editprofile') {
        page.querySelector('#push-page5').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('editusername.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'editusername') {
        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });

    document.addEventListener('init', function (event) {
      var page = event.target;
      if (page.id === 'editprofile') {
        page.querySelector('#push-page6').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('edittel.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'edittel') {
        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });

    document.addEventListener('init', function (event) {
      var page = event.target;
      if (page.id === 'editprofile') {
        page.querySelector('#push-page7').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('editpass.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'editpass') {
        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });

    document.addEventListener('init', function (event) {
      var page = event.target;
      if (page.id === 'editprofile') {
        page.querySelector('#push-page8').onclick = function () {
          document.querySelector('#myNavigator1').pushPage('editlocation.html', { data: { title: 'Fixing Man' } });
        };
      } else if (page.id === 'editlocation') {
        page.querySelector('ons-toolbar .center').innerHTML = page.data.title;
      }
    });
  </script>

  <!--  ======================================================tab3===================================================== -->

  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyB6QMhAaE3oktdyy8deswQNQIw4cwPq-W4",
      authDomain: "fixit-app-e3546.firebaseapp.com",
      databaseURL: "https://fixit-app-e3546.firebaseio.com",
      projectId: "fixit-app-e3546",
      storageBucket: "fixit-app-e3546.appspot.com",
      messagingSenderId: "139817871220",
      appId: "1:139817871220:web:b634b75fb562dcd2"
    };
    // Initialize Firebase

    firebase.initializeApp(firebaseConfig);
  </script>
  <script>


    document.addEventListener('prechange', function (event) {

      if (event.index == 0) {
        console.log('home clicked');
        // get data for map screen

      } else if (event.index == 1) {
        console.log('history clicked');
        // get data for coins screen

      }
      else if (event.index == 2) {
        console.log('setting clicked');
        // get data for history screen
      }


    });

    function settings() {


    }
  </script>

  <script>
    // app logout 
    function logout() {
      window.localStorage.clear();
      firebase.auth().signOut().then(function () {
        // Sign-out successful.
        ons.notification.alert('See u again soon');
        window.location.href = 'sign-in.html';

      }).catch(function (error) {
        // An error happened.
      });

    }

    function chat() {
      document.querySelector('#myNavigator1').pushPage('chat.html');

    }

    var email = localStorage.getItem("email");
    firestore.collection("Technicians").get().then(function (querySnapshot) {
      querySnapshot.forEach(function (doc) {
        // doc.data() is never undefined for query doc snapshots
        console.log(doc.id, " => ", doc.data());
        if (email == doc.data().email) {
          console.log("namestore" + doc.data().namestore);
          document.getElementById('namestore').innerHTML = doc.data().namestore;
          localStorage.setItem('namestore', doc.data().namestore);
          document.getElementById('addressstore').innerHTML = doc.data().address;
          document.getElementById('codestore').innerHTML = doc.data().codestore;
        }
      });
    });
    function editprofile() {
      document.querySelector('#myNavigator1').pushPage('editprofile.html');

    }

    
  </script>

  <!-- <script type="text/javascript" src="cordova.js"></script> -->
  <!-- <script type="text/javascript" src="js/home.js"></script> -->
  <!-- <script type="text/javascript" src="js/map.js"></script> -->

  <style>
    * {
      font-family: 'Pridi', serif;
    }

    .title {
      font-family: 'Pridi', serif;
    }

    .center {
      font-family: 'Pridi', serif;

    }

    .right {
      font-family: 'Pridi', serif;
    }

    .notificate {
      font-size: 16px;
    }

    .notitext {
      color: gray;
    }
  </style>
</body>

</html>